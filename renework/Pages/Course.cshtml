@page "/course/{id}"
@model renework.Pages.CourseModel
@using renework.MongoDB.Collections

@section Styles {
    <link rel="stylesheet" href="~/css/course.css" />
}

<div class="course-page">
    <div class="course-card">
        @if (Model.Course == null)
        {
            <div class="alert alert-danger">Course not found.</div>
        }
        else
        {
            <div class="course-title">@Model.Course.Title</div>
            <div class="course-meta">
                by @Model.Course.Company
            </div>
            <dl class="course-details">
                <dt>Tags</dt>
                <dd>@string.Join(", ", Model.Course.Tags)</dd>
                <dt>Duration</dt>
                <dd>@Model.Course.Duration</dd>
                <dt>Posted</dt>
                <dd>@Model.Course.Timestamp.ToLocalTime().ToString("g")</dd>
                <dt>Link</dt>
                <dd>
                    <a href="@Model.Course.Link" target="_blank" style="color:#D6A243;">@Model.Course.Link</a>
                </dd>
            </dl>
            <div class="course-actions">
                @if (User.Identity?.IsAuthenticated ?? false)
                {
                    @if (Model.HasApplied)
                    {
                        <button class="btn-course btn-secondary" disabled>Application Pending</button>
                    }
                    else
                    {
                        <a class="btn-course"
                           asp-page="/ApplyCourse"
                           asp-route-id="@Model.Id">
                            Apply for This Course
                        </a>
                    }
                }
                else
                {
                    <a class="btn-course"
                       asp-page="/Login"
                       asp-route-returnUrl="@Url.Page("/course/{id}", new { id = Model.Id })">
                        Login to Apply
                    </a>
                }
            </div>
        }
    </div>
</div>
