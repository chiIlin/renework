@page "/course/{id}"
@model renework.Pages.CourseModel
@using renework.MongoDB.Collections

@if (Model.Course == null)
{
    <div class="alert alert-danger">Course not found.</div>
}
else
{
    <h1 class="text-center my-4">@Model.Course.Title</h1>

    <div class="card mb-4">
        <div class="card-body">
            <p class="card-text">@Model.Course.Description</p>
            <dl class="row">
                <dt class="col-sm-3">Tags</dt>
                <dd class="col-sm-9">@string.Join(", ", Model.Course.Tags)</dd>

                <dt class="col-sm-3">Duration</dt>
                <dd class="col-sm-9">@Model.Course.Duration</dd>

                <dt class="col-sm-3">Posted</dt>
                <dd class="col-sm-9">@Model.Course.Timestamp.ToLocalTime().ToString("g")</dd>

                <dt class="col-sm-3">Link</dt>
                <dd class="col-sm-9">
                    <a href="@Model.Course.Link" target="_blank">@Model.Course.Link</a>
                </dd>
            </dl>
        </div>
    </div>

    @if (User.Identity?.IsAuthenticated ?? false)
    {
        @if (Model.HasApplied)
        {
            <button class="btn btn-secondary" disabled>Application Pending</button>
        }
        else
        {
            <a class="btn btn-success"
               asp-page="/ApplyCourse"
               asp-route-id="@Model.Id">
                Apply for This Course
            </a>
        }
    }
    else
    {
        <a class="btn btn-primary"
           asp-page="/Login"
           asp-route-returnUrl="@Url.Page("/course/{id}", new { id = Model.Id })">
            Login to Apply
        </a>
    }
}
