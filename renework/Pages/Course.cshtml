@* Pages/Course.cshtml *@
@page "/course/{id}"
@model renework.Pages.CourseModel
@using renework.MongoDB.Collections

<h1 class="my-4">@Model.Course.Title</h1>

<div class="mb-3">
    <p>@Model.Course.Description</p>
    <p><strong>Tags:</strong> @string.Join(", ", Model.Course.Tags)</p>
    <p><strong>Duration:</strong> @Model.Course.Duration</p>
    <p><strong>Posted:</strong> @Model.Course.Timestamp.ToLocalTime().ToString("g")</p>
    <p><a href="@Model.Course.Link" target="_blank">Course Link</a></p>
</div>

@if (User.Identity?.IsAuthenticated ?? false)
{
    @if (Model.AlreadyApplied)
    {
        <button class="btn btn-secondary" disabled>Already Applied</button>
    }
    else
    {
        <form method="post"
              asp-page-handler="Apply"
              asp-route-id="@Model.Id">
            @Html.AntiForgeryToken()
            <button type="submit" class="btn btn-primary">
                Apply for This Course
            </button>   
        </form>
    }
}
else
{
    <a class="btn btn-primary"
       asp-page="/Login"
       asp-route-returnUrl="@Url.Page("/course/{id}", new { id = Model.Id })">
        Login to Apply
    </a>
}
